---
title: "Residence Time Experiment"
author: "Emmi Mueller"
date: "July 23, 2019"
output: html_document
---

```{r}
getwd()
abundance <- read.csv("../GitHub/20190722_EAM_RT_12_UL_D1-9_Samples.csv", header = TRUE, sep = ",")

plot(log10(abundance$P1.Abs..Count[abundance$Sample=="A"]) ~ abundance$Day[abundance$Sample=="A"], col = "red", ylim= c(6,10), type = "b", pch = 16, xlab = "", ylab = "", axes = FALSE, cex = 1.2)
axis(2, at= c(6,7,8,9,10), labels = c(expression(paste("10"^"6")),expression(paste("10"^"7")), expression(paste("10"^"8")),expression(paste("10"^"9")), expression(paste("10"^"10"))), las = 2)
axis(1, at= abundance$Day, labels = ((abundance$Day)*24))
points(log10(abundance$P1.Abs..Count[abundance$Sample=="B"]) ~ abundance$Day[abundance$Sample=="B"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="C"]) ~ abundance$Day[abundance$Sample=="C"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="D"]) ~ abundance$Day[abundance$Sample=="D"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="E"]) ~ abundance$Day[abundance$Sample=="E"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="F"]) ~ abundance$Day[abundance$Sample=="F"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="G"]) ~ abundance$Day[abundance$Sample=="G"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="H"]) ~ abundance$Day[abundance$Sample=="H"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="I"]) ~ abundance$Day[abundance$Sample=="I"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="J"]) ~ abundance$Day[abundance$Sample=="J"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="K"]) ~ abundance$Day[abundance$Sample=="K"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
points(log10(abundance$P1.Abs..Count[abundance$Sample=="L"]) ~ abundance$Day[abundance$Sample=="L"], col = "red", ylim= c(6,10), type = "b", pch = 16, cex = 1.2)
mtext("Abundance (cells/mL)", side = 2, line = 3, cex = 1.4)
mtext("Time (hrs)", side = 1, line = 3, cex = 1.4)
box()

plot(log10(abundance$P1.Abs..Count[abundance$Day == "9"]) ~ log10(abundance$Tau[abundance$Day=="9"]), col = "red", type = "p", pch = 16, ylab = "", xlab = "", axes = FALSE, cex = 1.2, xlim = c(2,6))
axis(2, at= c(6,7,8), labels = c(expression(paste("10"^"6")),expression(paste("10"^"7")), expression(paste("10"^"8"))), las = 2)
axis(1, at = c(1,2,3,4,5,6), labels = c(expression(paste("10"^"1")),expression(paste("10"^"2")), expression(paste("10"^"3")), expression(paste("10"^"4")), expression(paste("10"^"5")), expression(paste("10"^"6"))), las = 1)
mtext("Abundance (cells/mL)", side = 2, line = 3, cex = 1.4)
mtext("Tau", side = 1, line = 3, cex = 1.4)
```

```{r}
coef(lm(logit(OD600_Ecoli_GC$OD600/0.9)~OD600_Ecoli_GC$minutes))
growthcurve_OD<-nls(OD600_Ecoli_GC$OD600~phi1/(1+exp(-(phi2+phi3*OD600_Ecoli_GC$minutes))),
 start=list(phi1=0.9,phi2=-2.805,phi3=0.031), data = OD600_Ecoli_GC, trace=TRUE)
phi1_OD<-coef(growthcurve_OD)[1]
phi2_OD<-coef(growthcurve_OD)[2]
phi3_OD<-coef(growthcurve_OD)[3]
x<-c(min(OD600_Ecoli_GC$minutes):max(OD600_Ecoli_GC$minutes))
y<-phi1_OD/(1+exp(-(phi2_OD+phi3_OD*x)))
predict_OD600<-data.frame(x,y)
```